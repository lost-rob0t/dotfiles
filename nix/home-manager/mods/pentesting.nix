{ lib, pkgs, config, ... }:
{
  imports = [
    ./pentesting/recon.nix
    ./pentesting/scanner.nix
    ./pentesting/webapp.nix
    ./pentesting/cracking.nix
    ./pentesting/exploitation.nix
    ./pentesting/reporting.nix
    ./pentesting/proxy.nix
  ];



  options = with lib; {
    pentesting = {
      enable = mkEnableOption "Enable pentesting tooling. Defaults to all.";
    };
  };

  config = with lib; mkIf config.pentesting.enable {

    pentesting = {
      recon.enable = mkDefault true;
      scanner.enable = mkDefault true;
      webapp.enable = mkDefault true;
      cracking.enable = mkDefault true;
      reporting.enable = mkDefault true;
      proxy.enable = mkDefault true;
    };

  };

}
