{ lib, pkgs, config, ... }:

{
  options = {
    # Enable desktop configuration
    desktop.enable = lib.mkEnableOption "Automatically configure the desktop";

    # Define a new option for a list of base desktop packages.
    desktop.basePackages = lib.mkOption {
      type = lib.types.listOf lib.types.package;
      default = with pkgs; [
        scrot
        flameshot
        keepassxc
        xdg-utils
        dunst
        gotop        # better htop
        recoll
        nim
        nimble
      ];
      description = "List of base packages to install on the desktop.";
    };

    games.enable = lib.mkEnableOption "Enable Gaming programs";
    media.enable = lib.mkEnableOption "Enable media programs";
  };

  # When desktop.enable is true, configure desktop-related settings.
  config = lib.mkIf config.desktop.enable {
    # Create a desktop item (for example, a Hibernate shortcut)
    desktop.hibernateDesktop = pkgs.makeDesktopItem {
      name = "Hibernate";
      desktopName = "Hibernate";
      exec = "${pkgs.pmutils}/bin/pm-hibernate";
      terminal = false;
    };

    # For example, add the desktop base packages to home.packages.
    # You can change this to whatever attribute or location you prefer.
    home.packages = config.desktop.basePackages;
  };
}
